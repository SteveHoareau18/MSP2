{% extends 'base.html.twig' %}

{% block body %}
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            {{ message }}
        {% endfor %}
    {% endfor %}
    <button><a href="{{ path('app_logout') }}">Se déconnecter</a></button>
    {% if app.user.verified == false %}
        <p>Vous devez activer votre compte en cliquant sur le lien envoyé par mail ! (no-reply@fresh.app)</p>
        <a href="{{ path('app_resend_registration_confirmation_email') }}">Cliquez pour renvoyer un lien
            d'activation</a>
    {% else %}
        <h1>Bonjour {{ user.firstname }}</h1>
        <h2>Vos alertes</h2>
        {% if alerts|length > 0 %}
            {% set legacyAlertString = "alerte" %}
            {% if alerts|length > 1 %}
                {% set legacyAlertString = "alertes" %}
            {% endif %}
            <p>Vous avez {{ alerts|length ~ " " ~ legacyAlertString }} !</p>
            {% for alert in alerts %}
                <div>
                    <div><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
                            <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
                            <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
                        </svg></div>
                    <div><p>{{ alert.food.name }} se trouvant dans {{ alert.refrigerator.name }}<br>Quantité : {{ alert.food.quantity }}<br>{{ alert.message }}</p></div>
                </div>
            {% endfor %}
        {% else %}
            <p>Aucune alerte, c'est bon signe !</p>
        {% endif %}
        <h2>Vos frigos</h2>
        {% if user.refrigerators|length == 0 %}
            <p>Vous n'avez pas de frigo, donc pas d'aliments !</p>
            <button><a href="{{ path('app_refrigerator_add') }}">Ajouter un frigo</a></button>
        {% else %}
            {% set number = 1 %}
            {% for refrigerator in user.refrigerators %}
                <p><a href="{{ path('app_refrigerator',{'number':number}) }}">
                        <img src="{{ asset('img/_fc63166d-6d43-4a34-a186-eb67efa4d00d.jpg') }}" alt="Frigo" height="512px" width="512px">{{ refrigerator.name }}</a></p>
                {% set number=number+1 %}
            {% endfor %}
        {% endif %}
    {% endif %}
{% endblock %}
